{% extends './layout.twig' %}
{% block title %}{{ trans("admin.account.login.key001") }}{% endblock %}
{% block body %}
    <body class="bg-primary d-flex justify-content-center align-items-center min-vh-100 p-5">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-xl-4 col-md-5">
                <div class="card">
                    <div class="card-body p-4">
                        <div class="text-center w-50 mx-auto auth-logo mt-2 mb-4">
                            <a href="{{ url('index') }}" class="logo-dark">
                                <img src="{{ __ASSETS__('images/logo-dark.png') }}" alt="" height="22">
                            </a>
                            <a href="{{ url('index') }}" class="logo-light">
                                <img src="{{ __ASSETS__('images/logo-light.png') }}" alt="" height="22">
                            </a>
                        </div>
                        <form class="mb-4" id="form" action="{{ url('admin.account.login') }}" autocomplete="off">
                            <div class="form-group mb-4">
                                <label class="form-label" for="email">{{ trans("admin.account.login.key002") }}</label>
                                <div class="input-group">
                                    <input class="form-control" name="email" type="email" id="email" data-rule="required" placeholder="{{ trans("admin.account.login.key003") }}" autocomplete="off">
                                </div>
                            </div>
                            <div class="form-group mb-4">
                                <label class="form-label" for="password">{{ trans("admin.account.login.key004") }}</label>
                                <div class="input-group">
                                    <input class="form-control" name="password" type="password" data-rule="required" id="password" placeholder="{{ trans("admin.account.login.key005") }}" autocomplete="new-password">
                                </div>
                            </div>
                            <div class="form-group mb-4">
                                <label class="form-label" for="captcha">{{ trans("admin.account.login.key008") }}</label>
                                <div class="input-group">
                                    <input class="form-control" maxlength="5" name="captcha" type="text" data-rule="required" id="captcha" placeholder="{{ trans("admin.account.login.key009") }}" autocomplete="new-password">
                                    <div class="captcha">
                                        <img id="captchaImg" src="{{ url('common.captcha', {'type': 'login-captcha'}) }}" alt="captcha" style="cursor:pointer"/>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group mb-3">
                                <input class="form-check-input" type="checkbox" id="rememberMe" checked>
                                <label class="form-check-label ms-2" for="rememberMe">{{ trans("admin.account.login.key006") }}</label>
                            </div>
                            <div class="form-group mb-0 text-center">
                                <button class="btn btn-primary w-100" type="submit">{{ trans("admin.account.login.key007") }}</button>
                            </div>
                        </form>
                    </div>
                </div>
                <!-- end card -->
                <div class="row mt-3">
                    <div class="col-12 text-center">
                        <p class="text-white-50">
                            <span>Powered by <a href="{{ base_uri }}" class="text-white font-weight-medium ms-1">{{ system_name }} {{ version }}</a></span>
                            <span>© 2010-<script>document.write(new Date().getFullYear())</script></span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        Do('base', 'form', () => {
            NProgress.start();
            NProgress.done();
            // 表单提交处理
            $('#form').isForm((rel) => {
                // 如果验证失败，刷新验证码
                if (![200, 302].includes(rel.code)) {
                    refreshCaptcha('#captchaImg');
                }
            });
            // 点击验证码图片时刷新
            $('#captchaImg').on('click', function () {
                refreshCaptcha(this);
            });

            // 封装验证码刷新函数
            function refreshCaptcha(selector) {
                const url = "{{ url('common.captcha', {'type': 'login-captcha'}) }}";
                const $el = typeof selector === 'string' ? $(selector) : $(selector);
                $el.attr('src', url + '?t=' + new Date().getTime());
            }
        });
    </script>
    </body>
{% endblock %}